{"version":3,"sources":["js/Http.js","js/index.js"],"names":["Http","constructor","uri","serialize","obj","qs","prop","encodeURIComponent","join","ErrorHandler","res","ok","Error","error","get","path","fetch","then","post","data","method","body","headers","delete","id","_default","exports","default","_Http","_interopRequireDefault","require","e","__esModule","container","document","querySelector","total","addProductForm","http","Row","product","price","render","arr","elems","map","totalCost","reduce","prev","curr","Number","innerHTML","loadAndRender","response","result","json","alert","addEventListener","preventDefault","target","elements","value","JSON","stringify","getAttribute"],"mappings":"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","file":"js.00a46daa.js","sourceRoot":"..\\src","sourcesContent":["class Http {\n  constructor(uri) {\n    this.uri = uri;\n  }\n  static serialize(obj) {\n    let qs = [];\n    for (let prop in obj) {\n      qs = [\n        ...qs,\n        `${encodeURIComponent(prop)}=${encodeURIComponent(obj[prop])}`,\n      ];\n    }\n    return qs.join(\"&\");\n  }\n  static ErrorHandler = (res) => {\n    if (!res.ok) throw new Error(res.error);\n    return res;\n  };\n  get(path = \"\", qs) {\n    return fetch(`${this.uri}${path}/?${Http.serialize(qs)}`).then(\n      Http.ErrorHandler\n    );\n  }\n  post(path = \"\", data) {\n    return fetch(`${this.uri}${path}`, {\n      method: \"POST\",\n      body: data,\n      headers: {\n        \"Content-Type\": \"application/json\",\n      },\n    }).then(Http.ErrorHandler);\n  }\n\n  delete(path = \"\", id) {\n    return fetch(`${this.uri}${path}/${id}`, {\n      method: \"DELETE\",\n    }).then(Http.ErrorHandler);\n  }\n}\n\nexport default Http;\n","// Write your code here...\nimport Http from \"./Http\";\nconst container = document.querySelector(\".list\");\nconst total = document.querySelector(\".total\");\nconst addProductForm = document.querySelector(\"form[name=add-product]\");\nconst http = new Http(\"http://localhost:3000/products\");\n\nconst Row = ({ product, price, id }) =>\n  `<div class=\"product\">\n    <span class=\"prod-name\">${product}</span>\n    <span class=\"prod-cost\">$${price}</span>\n    <div class=\"delete-btn\"><a href=\"#\" name=\"delete-btn\" data-id=\"${id}\">X</a></div>\n  </div>`;\n\nconst render = function (arr) {\n  const elems = arr.map((e) => Row(e));\n  const totalCost = arr.reduce((prev, curr) => prev + Number(curr.price), 0);\n\n  container.innerHTML = elems.join(\"\");\n  total.innerHTML = Row({ product: \"TOTAL\", price: totalCost });\n};\n\nasync function loadAndRender() {\n  try {\n    const response = await http.get();\n    const result = await response.json();\n    render(result);\n  } catch {\n    alert(\"There was an error talking to the server!\");\n  }\n}\n\nloadAndRender();\n\n// Add product and reload\naddProductForm.addEventListener(\"submit\", async function (e) {\n  e.preventDefault();\n  let product = e.target.elements.product;\n  let price = e.target.elements.price;\n  try {\n    if (product.value !== \"\" && price.value !== 0) {\n      await http.post(\n        \"/\",\n        JSON.stringify({ product: product.value, price: Number(price.value) })\n      );\n      loadAndRender();\n    }\n  } catch {\n    alert(\"There was an error storing data\");\n  } finally {\n    product.value = \"\";\n    price.value = 0;\n  }\n});\n\ncontainer.addEventListener(\"click\", async function (e) {\n  e.preventDefault();\n  if (e.target.getAttribute(\"name\") === \"delete-btn\") {\n    let id = e.target.getAttribute(\"data-id\");\n    try {\n      await http.delete(\"/\", id);\n      loadAndRender();\n    } catch {\n      alert(\"There was an error deleting data\");\n    }\n  }\n});\n"]}